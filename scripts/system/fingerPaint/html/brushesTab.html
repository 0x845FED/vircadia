<!--Note: change the parent postmessage second parameter due to possible security issues-->
<link rel="stylesheet" type="text/css" href="../../html/css/edit-style.css">
<script type="text/javascript" src="../../html/js/keyboardControl.js"></script>
<script src="../../html/js/jquery-2.1.4.min.js"></script>

<style>
   input[type=range] {
        -webkit-appearance: none;
        background: #2e2e2e;
        height: 1.8rem;
        border-radius: 1rem;
    }
    input[type=range]::-webkit-slider-thumb {
        -webkit-appearance:none;
        width: 0.6rem;
        height: 1.8rem;
        padding:0;
        margin: 0;
        background-color: #696969;
        border-radius: 1rem;
    }
    input[type=range]::-webkit-slider-thumb:hover {
        background-color: white;
    }
    input[type=range]:focus {
        outline: none;
    }
    .sliderWrapper {
        display: table;
        padding: 0.4rem 0;
    }
    .property.range input[type=number] {
        margin-left: 0.8rem;
        width: 5.4rem;
        height: 1.8rem;
    }
    .brushButton {
        background-color: #2e2e2e;
        border:none;
        position: relative;
        width: 80px;
        margin: 1px 0px;
    }
    .checkbox {
        margin: 0px;
    }
    .BrushIcon {
        width: 100%;
        height: 80px;
        background-size: 75% 75%;
        background-position: center;
        background-repeat: no-repeat;
        background-blend-mode: multiply;
        /*Just in case the user need to wait for the loading*/
        background-image: url("../../../../resources/icons/loadingDark.gif");
        -webkit-mask-repeat: no-repeat;
    }
    #animatedBrush {
        margin: 20px 0;
    }
    .selectedBrush {
        position: relative;
    }
    #selectedOverlay {
        background-color: rgba(16, 128, 184, 0.7);
        top:0;
        left:0;
        width: 100%;
        height: 100%;
        position: absolute;
        z-index: 1;
        color: white;
        font-size: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    #brushesCointainer {
        margin-bottom: 50px;
    }
    .imageContainer {
        display: block;
        position: relative;
        margin-bottom: 5px;
        height: 80px;
    }
    .brushLabel {
        display: block;
        position: relative;
        margin-bottom: 5px;
        color: white;
        width: 100%;
        font-size: 12px;
        z-index: 2;
        word-wrap: break-word;
        text-overflow: ellipsis;

    }
    #strokeWidthWidget {
        position: fixed;
        background-color: #404040;
        display: flex;
        z-index: 3;
        top: -1px;
        margin: 0px;
        padding: 15px 0px;
        border: none;
    }

    #pressureSensitiveCheckbox {
        margin-left: 20px;
        margin-top: 23px;
    }

    .animationBrush input[type=checkbox]:disabled + label, 
    .dynamicBrush input[type=checkbox]:disabled + label {
        color: #202020;
    }


</style>

<div id="strokeWidthWidget" class="property range">
    <div>
        <label style="display: block">Stroke Width</label>
        <div class="sliderWrapper">
            <input type="range" id="lineWidthRange" value=0.25 min=0 max=1 step=0.01 onchange="changeLineWidthRange(this)"/>
            <input type="number" id="lineWidthText" value=0.25 min=0 max=1 step=0.01 onchange="changeLineWidthNumber(this)"/>
        </div>
    </div>
    <div id="pressureSensitiveCheckbox" class="behavior-group property checkbox">
        <input onchange="switchPressureSensitiveWidth(this)"  type="checkbox" id="triggerSensitiveWidth"></input>
        <label for="triggerSensitiveWidth">Trigger Sensitive Width</label>
    </div>
</div>
<div style="margin-top: 75px">

    <div class="behavior-group property checkbox">
        <input onchange="setContinuosLineMode(this)" type="checkbox" id="continuousLine"></input>
        <label for="continuousLine">Use Continuous Line</label>
    </div>
    
    <div class="behavior-group property checkbox animationBrush">
        <input onchange="setAnimatedBrush(this)" animationType="animatedHueBrush" type="checkbox" id="animatedBrush"></input>
        <label for="animatedBrush">Use Hue Animation</label>
    </div>

    <div class="behavior-group property checkbox dynamicBrush">
        <input onchange="setDynamicBrush(this)" type="checkbox" id="dynamicHue"></input>
        <label for="dynamicHue">Use Dynamic Hue</label>
    </div>

    <div class="behavior-group property checkbox dynamicBrush">
        <input onchange="setDynamicBrush(this)" type="checkbox" id="dynamicSaturation"></input>
        <label for="dynamicSaturation">Use Dynamic Saturation</label>
    </div>

    <div class="behavior-group property checkbox dynamicBrush">
        <input onchange="setDynamicBrush(this)" type="checkbox" id="dynamicValue"></input>
        <label for="dynamicValue">Use Dynamic Brightness</label>
    </div>
    <!--<div>
        <div style="float: left; margin-right: 20px">
            <div class="behavior-group property checkbox">
                <input onchange="setAnimatedBrush(this)" animationType="animatedRotationBrush" type="checkbox" id="yawRotationBrush"></input>
                <label for="yawRotationBrush">Use Yaw Rotation</label>
            </div>
             <div class="behavior-group property checkbox">
                <input onchange="setAnimatedBrush(this)" animationType="animatedRotationBrush" type="checkbox" id="pitchRotationBrush"></input>
                <label for="pitchRotationBrush">Use Pitch Rotation</label>
            </div>
             <div class="behavior-group property checkbox">
                <input onchange="setAnimatedBrush(this)" animationType="animatedRotationBrush" type="checkbox" id="rollRotationBrush"></input>
                <label for="rollRotationBrush">Use Roll Rotation</label>
            </div>
        </div>
        <div>
             <div class="behavior-group property checkbox">
                <input onchange="setAnimatedBrush(this)" animationType="animatedTranslationBrush" type="checkbox" id="xTranslationBrush"></input>
                <label for="xTranslationBrush">Use Translation x</label>
            </div>
             <div class="behavior-group property checkbox">
                <input onchange="setAnimatedBrush(this)" animationType="animatedTranslationBrush" type="checkbox" id="yTranslationBrush"></input>
                <label for="yTranslationBrush">Use Translation y</label>
            </div>
             <div class="behavior-group property checkbox">
                <input onchange="setAnimatedBrush(this)" animationType="animatedTranslationBrush" type="checkbox" id="zTranslationBrush"></input>
                <label for="zTranslationBrush">Use Translation z</label>
            </div>
        </div>
    </div>-->


    <div id="brushesCointainer">
        <button class="brushButton"  brushType="stretch"  id="content/brushes/square.png" onclick="changePaintBrush(0)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/square.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Square</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/paintbrush6.png" onclick="changePaintBrush(1)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush6.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Rounded</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/soft.png" onclick="changePaintBrush(2)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/soft.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Soft</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/256x256/dupuiz.png" onclick="changePaintBrush(3)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/dupuiz.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Tri</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/256x256/basic.png" onclick="changePaintBrush(4)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/basic.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Basic</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/oil.png" onclick="changePaintBrush(5)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/oil.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Oil</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/256x256/gouache.png" onclick="changePaintBrush(6)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/gouache.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Gouache A</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/256x256stretched/gouache.png" onclick="changePaintBrush(7)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256stretched/gouache.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Gouache B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/koons.png" onclick="changePaintBrush(8)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/koons.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Koons</div>
        </button>

         <button class="brushButton"  brushType="stretch"  id="content/brushes/256x256/sponge.png" onclick="changePaintBrush(9)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/sponge.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Sponge A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/256x256stretched/sponge.png" onclick="changePaintBrush(10)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256stretched/sponge.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Sponge B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/256x256/graphite.png" onclick="changePaintBrush(11)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/graphite.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Graphite</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/256x256/bristle.png" onclick="changePaintBrush(12)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/bristle.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Bristle</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/256x256/spat-fine.png" onclick="changePaintBrush(13)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/spat-fine.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Spat</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/gradient2.png" onclick="changePaintBrush(14)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gradient2.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Gradient A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gradient2.png" onclick="changePaintBrush(15)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gradient2.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Gradient B</div>
        </button>


        <button class="brushButton"  brushType="repeat"  id="content/brushes/gimickkywhite/dot.png" onclick="changePaintBrush(16)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gimickkywhite/dot.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Dot</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gimickkywhite/polka.png" onclick="changePaintBrush(17)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gimickkywhite/polka.png" class="BrushIcon"/></div>
            </div>
            <div class="brushLabel">Polka</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gimickkywhite/heart.png" onclick="changePaintBrush(18)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gimickkywhite/heart.png" class="BrushIcon"/></div>
            </div>
            <div class="brushLabel">Heart</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gimickkywhite/hearts.png" onclick="changePaintBrush(19)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gimickkywhite/hearts.png" class="BrushIcon"/></div>
            </div>
            <div class="brushLabel">Hearts</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gimickkywhite/flowers2.png" onclick="changePaintBrush(20)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gimickkywhite/flowers2.png" class="BrushIcon"/></div>
            </div>
            <div class="brushLabel">Flowers</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gimickkywhite/leaves.png" onclick="changePaintBrush(21)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gimickkywhite/leaves.png" class="BrushIcon"/></div>
            </div>
            <div class="brushLabel">Leaves</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gimickkywhite/snowflakes2.png" onclick="changePaintBrush(22)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gimickkywhite/snowflakes2.png" class="BrushIcon"/></div>
            </div>
            <div class="brushLabel">Snowflakes</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/paintbrush1.png" onclick="changePaintBrush(23)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush1.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Stars</div>
        </button>

        <button class="brushButton" colored="true" brushType="stretch"  id="content/brushes/colored/breakfast.png" onclick="changePaintBrush(24)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/breakfast.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Breakfast</div>
        </button>

        <button class="brushButton" colored="true" brushType="stretch"  id="content/brushes/colored/newton.png" onclick="changePaintBrush(25)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/newton.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Newton</div>
        </button>


        <button class="brushButton" colored="true" brushType="stretch"  id="content/brushes/colored/softy.png" onclick="changePaintBrush(26)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/softy.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">Softbow</div>
        </button>


        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/256x256/basic.png" onclick="changePaintBrush(1)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/basic.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">basic B</div>
        </button>-->

   

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/256x256/bristle.png" onclick="changePaintBrush(3)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/bristle.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">bristle B</div>
        </button>-->

       
        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/256x256/dupuiz.png" onclick="changePaintBrush(5)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/dupuiz.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">dupuiz B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/256x256/gouache.png" onclick="changePaintBrush(7)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/gouache.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">gouache B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/256x256/graphite.png" onclick="changePaintBrush(9)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/graphite.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">graphite B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/256x256/spat-fine.png" onclick="changePaintBrush(11)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/spat-fine.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">spat-fine B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="stretch"  id="content/brushes/256x256/spat-medium.png" onclick="changePaintBrush(12)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/spat-medium.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">spat-medium A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/256x256/spat-medium.png" onclick="changePaintBrush(13)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/spat-medium.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">spat-medium B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/256x256/sponge.png" onclick="changePaintBrush(15)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256/sponge.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">sponge B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="stretch"  id="content/brushes/256x256stretched/basic.png" onclick="changePaintBrush(16)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256stretched/basic.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">basic A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/256x256stretched/basic.png" onclick="changePaintBrush(17)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256stretched/basic.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">basic B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/256x256stretched/bristle.png" onclick="changePaintBrush(18)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256stretched/bristle.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">bristle A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/256x256stretched/bristle.png" onclick="changePaintBrush(19)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256stretched/bristle.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">bristle B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/256x256stretched/gouache.png" onclick="changePaintBrush(21)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256stretched/gouache.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">gouache B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="stretch"  id="content/brushes/256x256stretched/sponge.png" onclick="changePaintBrush(22)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/256x256stretched/sponge.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">sponge A</div>
        </button>-->


        <!--<button class="brushButton"  brushType="stretch"  id="content/brushes/basic.png" onclick="changePaintBrush(24)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/basic.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">basic A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/basic.png" onclick="changePaintBrush(25)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/basic.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">basic B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/bristle.png" onclick="changePaintBrush(26)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/bristle.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">bristle A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/bristle.png" onclick="changePaintBrush(27)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/bristle.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">bristle B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/gouache.png" onclick="changePaintBrush(28)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gouache.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">gouache A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gouache.png" onclick="changePaintBrush(29)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gouache.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">gouache B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/gradient.png" onclick="changePaintBrush(30)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gradient.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">gradient A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gradient.png" onclick="changePaintBrush(31)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gradient.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">gradient B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="stretch"  id="content/brushes/gradient3.png" onclick="changePaintBrush(34)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gradient3.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">gradient3 A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/gradient3.png" onclick="changePaintBrush(35)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/gradient3.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">gradient3 B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/koons.png" onclick="changePaintBrush(37)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/koons.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">koons B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/oil.png" onclick="changePaintBrush(39)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/oil.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">oil B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="stretch"  id="content/brushes/paintbrush1.png" onclick="changePaintBrush(40)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush1.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush1 A</div>
        </button>-->

        <!--<button class="brushButton"  brushType="stretch"  id="content/brushes/paintbrush2.png" onclick="changePaintBrush(42)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush2.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush2 A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/paintbrush2.png" onclick="changePaintBrush(43)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush2.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush2 B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/paintbrush3.png" onclick="changePaintBrush(44)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush3.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush3 A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/paintbrush3.png" onclick="changePaintBrush(45)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush3.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush3 B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/paintbrush4.png" onclick="changePaintBrush(46)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush4.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush4 A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/paintbrush4.png" onclick="changePaintBrush(47)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush4.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush4 B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/paintbrush5.png" onclick="changePaintBrush(48)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush5.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush5 A</div>
        </button>

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/paintbrush5.png" onclick="changePaintBrush(49)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush5.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush5 B</div>
        </button>-->

      
        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/paintbrush6.png" onclick="changePaintBrush(51)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/paintbrush6.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">paintbrush6 B</div>
        </button>

        <!--<button class="brushButton"  brushType="stretch"  id="content/brushes/pastel.png" onclick="changePaintBrush(52)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/pastel.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">pastel A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/pastel.png" onclick="changePaintBrush(53)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/pastel.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">pastel B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/soft.png" onclick="changePaintBrush(55)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/soft.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">soft B</div>
        </button>

        <button class="brushButton"  brushType="stretch"  id="content/brushes/sponge.png" onclick="changePaintBrush(56)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/sponge.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">sponge A</div>
        </button>

        <button class="brushButton"  brushType="repeat"  id="content/brushes/sponge.png" onclick="changePaintBrush(57)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/sponge.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">sponge B</div>
        </button>-->

        <!--<button class="brushButton"  brushType="repeat"  id="content/brushes/square.png" onclick="changePaintBrush(59)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/square.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">square B</div>
        </button>-->

        <!--<button class="brushButton" colored="true" brushType="repeat"  id="content/brushes/colored/breakfast.png" onclick="changePaintBrush(61)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/breakfast.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">breakfast B</div>
        </button>

        <button class="brushButton" colored="true" brushType="stretch"  id="content/brushes/colored/chique.png" onclick="changePaintBrush(62)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/chique.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">chique A</div>
        </button>

        <button class="brushButton" colored="true" brushType="repeat"  id="content/brushes/colored/chique.png" onclick="changePaintBrush(63)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/chique.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">chique B</div>
        </button>

        <button class="brushButton" colored="true" brushType="stretch"  id="content/brushes/colored/hawaii.png" onclick="changePaintBrush(64)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/hawaii.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">hawaii A</div>
        </button>

        <button class="brushButton" colored="true" brushType="repeat"  id="content/brushes/colored/hawaii.png" onclick="changePaintBrush(65)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/hawaii.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">hawaii B</div>
        </button>-->



        <!--<button class="brushButton" colored="true" brushType="repeat"  id="content/brushes/colored/newton.png" onclick="changePaintBrush(67)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/newton.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">newton B</div>
        </button>

        <button class="brushButton" colored="true" brushType="stretch"  id="content/brushes/colored/pastels.png" onclick="changePaintBrush(68)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/pastels.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">pastels A</div>
        </button>

        <button class="brushButton" colored="true" brushType="repeat"  id="content/brushes/colored/pastels.png" onclick="changePaintBrush(69)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/pastels.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">pastels B</div>
        </button>-->

        <!--<button class="brushButton" colored="true" brushType="repeat"  id="content/brushes/colored/softy.png" onclick="changePaintBrush(71)">
            <div class="imageContainer">
                <div imageSrc="../content/brushes/colored/softy.png" class="BrushIcon"></div>
            </div>
            <div class="brushLabel">softy B</div>
        </button>-->
    </div>
</div>



<script type="text/javascript">
    var currentBrush = 0;
    setStrokeColor({red: 255, green: 0, blue: 0});
    var EventBridge = parent.EventBridge;

    function changeLineWidthRange(e) {
        document.getElementById("lineWidthText").value = e.value;
        notifyLineWidthChanged(e);
    }

    function changeLineWidthNumber(e) {
        if (e.value > 1) {
            document.getElementById("lineWidthText").value = 1;
        }
        document.getElementById("lineWidthRange").value = e.value > 1 ? 1 : e.value;
        notifyLineWidthChanged(e);
    }

    function notifyLineWidthChanged(e) {
          var changeLineWidthEvent = {
            "type"     : "changeLineWidth",
            "brushWidth":  e.value
        };
        parent.postMessage(JSON.stringify(changeLineWidthEvent), "*");
    }

    function switchPressureSensitiveWidth(checkbox) {
        // 'jscolor' instance can be used as a string
        var switchPressureSensitiveWidthEvent = {
            "type"    : "switchTriggerPressureWidth",
            "enabled" : checkbox.checked,
        };
        parent.postMessage(JSON.stringify(switchPressureSensitiveWidthEvent), "*");
    }

    function changePaintBrush(brushIndex) {
        var brushes = document.getElementById("brushesCointainer").children;
        brushes[currentBrush].classList.remove("selectedBrush");
        if (document.getElementById("selectedOverlay"))
            document.getElementById("selectedOverlay").remove();
        
        currentBrush = brushIndex;
        brushes[currentBrush].classList.add("selectedBrush");

        var selectedOverlay = document.createElement("div");
        selectedOverlay.id = "selectedOverlay";        
        selectedOverlay.innerHTML  = "&#x2714";
        brushes[currentBrush].children[0].appendChild(selectedOverlay);

        var changedBrushEvent = {
            "type"     : "changeBrush",
            "brushName": brushes[currentBrush].id,
            "brushType": brushes[currentBrush].getAttribute("brushType"),
            "isColored": brushes[currentBrush].getAttribute("colored"),
            "brushID"  : brushIndex
        };

        parent.postMessage(JSON.stringify(changedBrushEvent), "*");
    }

    function calculateAnimatedAxis(checkbox) {
        if (checkbox.getAttribute("animationType") == "animatedRotationBrush") {
            return {
                axis: {
                    x: document.getElementById("pitchRotationBrush").checked ? 1 : 0,
                    y: document.getElementById("rollRotationBrush").checked ? 1 : 0,
                    z: document.getElementById("yawRotationBrush").checked ? 1 : 0
                }
            }
        }
        if (checkbox.getAttribute("animationType") == "animatedTranslationBrush") {
            return {
                axis: {
                    x: document.getElementById("xTranslationBrush").checked ? 1 : 0,
                    y: document.getElementById("yTranslationBrush").checked ? 1 : 0,
                    z: document.getElementById("zTranslationBrush").checked ? 1 : 0
                }
            }
        } else return null;
    }

    function calculateEnabledStatus(checkbox, settings) {        
        if (checkbox.getAttribute("animationType") == "animatedHueBrush") {
            return checkbox.checked;
        } 
        return settings.axis.x == 1 || settings.axis.y == 1 || settings.axis.z == 1;
    }

    function switchDynamicBrushEnabledStatus(checkbox) {
        var isAnyAnimatedChecked = false;
        $(".animationBrush").each(function( index ) {
            isAnyAnimatedChecked |= $(this).find("input[type=checkbox]")[0].checked;
        });
        $(".dynamicBrush").each(function( index ) {
            $(this).find("input[type=checkbox]")[0].disabled = isAnyAnimatedChecked;
        });
    }

    function switchAnimationBrushEnabledStatus(checkbox) {
         var isAnyDynamicChecked = false;
        $(".dynamicBrush").each(function( index ) {
            isAnyDynamicChecked |= $(this).find("input[type=checkbox]")[0].checked;
        });
        $(".animationBrush").each(function( index ) {
            $(this).find("input[type=checkbox]")[0].disabled = isAnyDynamicChecked;
        });
    }

    function setAnimatedBrush(checkbox) {
        switchDynamicBrushEnabledStatus();
        var settings = calculateAnimatedAxis(checkbox);
        var switchAnimatedBrushEvent = {
            "type"            : "switchAnimatedBrush",
            "animatedBrushName": checkbox.getAttribute("animationType"),
            "enabled"         : calculateEnabledStatus(checkbox, settings),
            "settings"        : settings,
            "animatedBrushID"  : checkbox.id
        };
        parent.postMessage(JSON.stringify(switchAnimatedBrushEvent), "*");
    }

    function setDynamicBrush(checkbox) {
        switchAnimationBrushEnabledStatus();
        var switchDynamicBrushEvent = {
            "type"            : "switchDynamicBrush",
            "enabled"         : checkbox.checked,
            "dynamicBrushId"  : checkbox.id
        };
        parent.postMessage(JSON.stringify(switchDynamicBrushEvent), "*");
    }

    function setContinuosLineMode(checkbox) {
        var switchContinuousDrawModeEvent = {
            "type"    : "switchIsContinuous",
            "enabled" : checkbox.checked,
        };
        parent.postMessage(JSON.stringify(switchContinuousDrawModeEvent), "*");
    }

    function resizeImage(image, width, height) {
        var height = height == width ? "80px" : "40px";
        image.css("height", height);
        image.first().css("background-image", "url(" + image.attr('imageSrc') + ")");
        image.first().css("background-size", "contain");
        image.first().css("background-position", "center");
        if (height == "40px") {
            image.first().css("top", "18px");
            image.first().css("position", "absolute");
        }
    }

    function setStrokeColor(strokeColor) {
        $(".imageContainer").each(function( index ) {
            //recalculate the image height so it keeps the aspect ratio
            var image = new Image();
            image.src = $(this).find('div').first().attr('imageSrc');
            var img = $(this).find('div').first();
            image.addEventListener("load", function(){
                resizeImage(img, this.naturalWidth, this.naturalHeight);
            });
            
            if (!$(this).parent().attr("colored")) {
                $(this).find('div').first().css("-webkit-mask-box-image", "url(" + $(this).find('div').first().attr('imageSrc') + ")");
                $(this).find('div').first().css("background-color", "rgb(" + strokeColor.red + ", " + strokeColor.green + ", " + strokeColor.blue + ")");
            }
        });        
    }
    
    restoreSavedBrushes(JSON.parse(decodeURIComponent(window.parent.location.search).substring(1)));
    function restoreSavedBrushes(brushData) {
        if ("currentTexture" in brushData) {
            changePaintBrush(brushData.currentTexture.brushID);
        }

        if ("currentAnimatedBrushes" in brushData) {
            var animatedBrushes = brushData.currentAnimatedBrushes;
            for (var i = 0; i < animatedBrushes.length; i++) {
                document.getElementById(animatedBrushes[i]).checked = true;
            }
            switchDynamicBrushEnabledStatus();
        }

        if ("currentDynamicBrushes" in brushData) {
            for(var key in brushData.currentDynamicBrushes) {
                document.getElementById(key).checked = brushData.currentDynamicBrushes[key];
            }
            switchAnimationBrushEnabledStatus();
        }

        if ("currentColor" in brushData) {
            setStrokeColor(brushData.currentColor);
        }

        if ("currentStrokeWidth" in brushData) {
            document.getElementById("lineWidthRange").value = brushData.currentStrokeWidth;
            changeLineWidthRange({value: brushData.currentStrokeWidth});
            changeLineWidthNumber({value: brushData.currentStrokeWidth});
        }

        if ("currentTriggerWidthEnabled" in brushData) {
            document.getElementById("triggerSensitiveWidth").checked = brushData.currentTriggerWidthEnabled;
        }

        if ("currentIsContinuous" in brushData) {
            document.getElementById("continuousLine").checked = brushData.currentIsContinuous;
        }
    }


    window.addEventListener("message", receiveStrokeColor, false);
    function receiveStrokeColor(message) {
        var event = JSON.parse(message.data);
        setStrokeColor(event.value);
    }

    $(window).load(function(){ 
        setUpKeyboardControl();
    });


</script>